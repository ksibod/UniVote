{% extends "elections/base.html" %}
{% block content %}
<h1>{{ election.election_text }} Elections</h1>


<h3>Races listed:</h3>
<!-- Cycle through all races assigned to an election -->
<!-- Start loop through races in this election and list race details -->
{% for race in election.race_set.all %}
<hr>
	<h4>{{ race.race_name }}</h4>
	<h6>{{ race.race_description }}</h6>
	<p>{{ race.race_detail }}</p>

	<table><th>List of Candidates</th>
 		<!-- Cycle through the candidates entered in this race, and post their details -->
 		{% for candidate in race.candidate_set.all %}
		<tr><td>{{ candidate.user.first_name }} {{ candidate.user.last_name }}<td>
			<td><a href="/elections/profile/{{ candidate.user_id }}/">Profile</a></td>
		</tr>
 		{% endfor %} <!-- End candidate cycle -->

	</table>
<!-- Check to see if user is entered as a candidate in this race, if not then give add button -->
		{% for r, candidates in races.items %}

			<!-- if the race in the cycle equals the race in the dict, then do -->
			{% ifequal r race %}

				<!-- if the user is a candidate entered in this race, then message -->
				{% if user.id in candidates %}
				<p>You are a candidate in this race.</p>

				{% else %} <!-- Give button to enter as a candidate. -->
				<form action="/elections/candidate_register/{{ race.id }}/"method="post">
				{% csrf_token %}
					<input type="submit" value="Become a Candidate" />
				</form>
				{% endif %}

			{% endifequal %}

		{% endfor %}

 {% endfor %} <!-- End race cycle -->
 {% endblock %}

{% block bottom %}
<!-- Lower links of the voting form -->
<br><hr>
<table>
	<tr>
		<td><a style="color:white; text-decoration:none; margin-left:2em; border: 1px solid white; border-radius:8px;
                    padding: 5px; background-color:#2064db; font-weight: bold;" href="/elections/">Return to Elections</a></td>
	</tr>
</table>
{% endblock %}

